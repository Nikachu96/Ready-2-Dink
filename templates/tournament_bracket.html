{% extends "base.html" %}

{% block title %}Tournament Bracket - {{ tournament.name }} - Ready 2 Dink{% endblock %}

{% block content %}
<!-- Breadcrumb Navigation -->
<div class="row mb-3">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0" style="background: transparent;">
                <li class="breadcrumb-item">
                    <a href="{{ url_for('dashboard', player_id=session.get('current_player_id')) }}" class="text-decoration-none" style="color: var(--neon-purple);">
                        <i class="fas fa-home me-1"></i>Dashboard
                    </a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{{ url_for('tournaments_overview') }}" class="text-decoration-none" style="color: var(--neon-purple);">
                        <i class="fas fa-trophy me-1"></i>Tournaments
                    </a>
                </li>
                <li class="breadcrumb-item active text-white" aria-current="page">
                    <i class="fas fa-sitemap me-1"></i>Tournament Bracket
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Back Button -->
<div class="row mb-3">
    <div class="col-12">
        <div class="d-flex align-items-center justify-content-between">
            <a href="{{ url_for('tournaments_overview') }}" class="btn btn-outline-light btn-sm d-flex align-items-center">
                <i class="fas fa-arrow-left me-2"></i>Back to Tournaments
            </a>
            <div class="d-none d-md-block">
                <small class="text-muted">
                    <i class="fas fa-info-circle me-1"></i>
                    Use zoom controls to navigate the bracket on mobile
                </small>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-header text-white" style="background: var(--gradient-primary); border: none;">
                <div class="d-flex align-items-center justify-content-between">
                    <div class="d-flex align-items-center">
                        <img src="{{ url_for('static', filename='images/ready2dink-logo-new.png') }}" alt="Ready 2 Dink" style="height: 40px; width: auto;" class="me-3">
                        <div>
                            <h4 class="card-title mb-0 fw-bold">{{ tournament.name }}</h4>
                            <p class="mb-0 opacity-90">Tournament Bracket - {{ tournament.skill_level }} Level</p>
                        </div>
                    </div>
                    <div class="text-end">
                        <span class="badge bg-warning fs-6">${{ "%.0f"|format(tournament.entry_fee) }}</span>
                        <br>
                        <small class="opacity-75">{{ tournament.current_players }}/{{ tournament.max_players }} players</small>
                    </div>
                </div>
            </div>
            <div class="card-body">
                {% if tournament.status == 'open' %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Tournament is still open for registration. Bracket will be generated when registration closes.
                </div>
                {% elif not matches %}
                <div class="alert alert-warning">
                    <i class="fas fa-hourglass-half me-2"></i>
                    Bracket is being generated. Please check back soon!
                </div>
                {% else %}
                
                <!-- Tournament Status -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <span class="badge bg-{{ 'success' if tournament.status == 'completed' else 'primary' }} fs-6">
                            {% if tournament.status == 'completed' %}
                                Completed
                            {% elif tournament.status == 'active' %}
                                In Progress
                            {% else %}
                                {{ tournament.status|title }}
                            {% endif %}
                        </span>
                    </div>
                    {% if player_entry %}
                    <div class="text-end">
                        <strong class="text-primary">Your Position:</strong> 
                        <span class="badge bg-primary">Seed #{{ player_entry.bracket_position or 'TBD' }}</span>
                    </div>
                    {% endif %}
                </div>

                <!-- Player Upcoming Matches & Opponent Info -->
                {% if current_player_context and current_player_context.upcoming_matches %}
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card" style="background: linear-gradient(135deg, rgba(63, 86, 127, 0.1) 0%, rgba(209, 116, 210, 0.1) 100%); border: 1px solid rgba(63, 86, 127, 0.3);">
                            <div class="card-header" style="background: rgba(63, 86, 127, 0.2); border-bottom: 1px solid rgba(63, 86, 127, 0.3);">
                                <h5 class="mb-0 text-white">
                                    <i class="fas fa-calendar-alt me-2"></i>Your Upcoming Matches
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    {% for match in current_player_context.upcoming_matches %}
                                    <div class="col-md-6 mb-3">
                                        <div class="card h-100" style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(63, 86, 127, 0.2);">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center justify-content-between mb-2">
                                                    <h6 class="text-white mb-0">
                                                        {% if match.round_number == max_rounds %}
                                                            üèÜ Final
                                                        {% elif match.round_number == max_rounds - 1 %}
                                                            ü•à Semifinal  
                                                        {% elif match.round_number == max_rounds - 2 %}
                                                            ü•â Quarterfinal
                                                        {% else %}
                                                            Round {{ match.round_number }}
                                                        {% endif %}
                                                    </h6>
                                                    <span class="badge bg-primary">Match {{ match.match_number }}</span>
                                                </div>
                                                
                                                {% if match.opponent_name %}
                                                <div class="d-flex align-items-center mb-3">
                                                    <div class="me-3">
                                                        <i class="fas fa-user-circle fa-2x" style="color: var(--neon-purple);"></i>
                                                    </div>
                                                    <div>
                                                        <h6 class="text-white mb-1">{{ match.opponent_name }}</h6>
                                                        <small class="text-muted">{{ match.opponent_skill }} Level</small>
                                                    </div>
                                                </div>
                                                
                                                <!-- Next Opponent's Last Match Display -->
                                                {% if loop.first and current_player_context.next_opponent_last_match %}
                                                <div class="mt-3 p-3" style="background: rgba(209, 116, 210, 0.1); border-radius: 8px; border-left: 3px solid var(--neon-purple);">
                                                    <h6 class="text-white mb-2">
                                                        <i class="fas fa-history me-2"></i>{{ match.opponent_name }}'s Last Match
                                                    </h6>
                                                    <div class="row text-center">
                                                        <div class="col-4">
                                                            <div class="text-white-50 small">Opponent</div>
                                                            <div class="text-white fw-bold">{{ current_player_context.next_opponent_last_match.opponent_opponent_name or 'N/A' }}</div>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="text-white-50 small">Score</div>
                                                            <div class="text-white">
                                                                {{ current_player_context.next_opponent_last_match.next_opponent_score or '-' }} - {{ current_player_context.next_opponent_last_match.opponent_opponent_score or '-' }}
                                                            </div>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="text-white-50 small">Result</div>
                                                            <span class="badge bg-{{ 'success' if current_player_context.next_opponent_last_match.next_opponent_result == 'W' else 'danger' }}">
                                                                {{ current_player_context.next_opponent_last_match.next_opponent_result or 'N/A' }}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% elif loop.first %}
                                                <div class="mt-3 p-2 text-center">
                                                    <small class="text-muted">
                                                        <i class="fas fa-info-circle me-1"></i>No previous match data available for {{ match.opponent_name }}
                                                    </small>
                                                </div>
                                                {% endif %}
                                                {% else %}
                                                <div class="text-center">
                                                    <div class="text-muted">
                                                        <i class="fas fa-question-circle fa-2x mb-2"></i>
                                                        <p class="mb-0">Opponent TBD</p>
                                                        <small>Waiting for previous matches to complete</small>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Focused Match Information - Simplified View -->
                <div class="focused-bracket-container">
                    <div class="row">
                        <!-- Tournament Champion Display (if completed) -->
                        {% if tournament.status == 'completed' %}
                        <div class="col-12 mb-4">
                            <div class="card text-center" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: #000;">
                                <div class="card-body py-5">
                                    <i class="fas fa-trophy fa-4x mb-3"></i>
                                    <h3 class="fw-bold mb-3">Tournament Champion</h3>
                                    {% for round_num, round_matches in matches_by_round.items() %}
                                        {% if round_num == max_rounds %}
                                            {% for match in round_matches %}
                                                {% if match.winner_id %}
                                                    <div class="champion-info">
                                                        <h4 class="mb-2">
                                                            {{ match.player1_name if match.winner_id == match.player1_id else match.player2_name }}
                                                        </h4>
                                                        <p class="mb-0 fs-5">Final Score: {{ match.player1_score }} - {{ match.player2_score }}</p>
                                                    </div>
                                                {% endif %}
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Your Previous Match Result -->
                        {% if current_player_context and current_player_context.previous_matches %}
                        <div class="col-12 col-lg-6 mb-4">
                            <div class="neon-frame h-100">
                                <div class="card-header text-white" style="background: rgba(209, 116, 210, 0.2);">
                                    <h5 class="mb-0">
                                        <i class="fas fa-history me-2"></i>Your Previous Match
                                    </h5>
                                </div>
                                <div class="card-body">
                                    {% set last_match = current_player_context.previous_matches[0] %}
                                    <div class="text-center mb-3">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="p-3 rounded {{ 'bg-success' if last_match.winner_id == current_player_id else 'bg-danger' }} bg-opacity-10 border {{ 'border-success' if last_match.winner_id == current_player_id else 'border-danger' }}">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div class="flex-grow-1">
                                                            <h6 class="mb-1">vs {{ last_match.opponent_name }}</h6>
                                                            <small class="text-muted">
                                                                {% if last_match.round_number == max_rounds %}
                                                                    üèÜ Final
                                                                {% elif last_match.round_number == max_rounds - 1 %}
                                                                    ü•à Semifinal
                                                                {% elif last_match.round_number == max_rounds - 2 %}
                                                                    ü•â Quarterfinal
                                                                {% else %}
                                                                    Round {{ last_match.round_number }}
                                                                {% endif %}
                                                            </small>
                                                        </div>
                                                        <div class="text-end">
                                                            <span class="badge fs-6 {{ 'bg-success' if last_match.winner_id == current_player_id else 'bg-danger' }}">
                                                                {{ 'WIN' if last_match.winner_id == current_player_id else 'LOSS' }}
                                                            </span>
                                                            <div class="mt-1">
                                                                <strong class="fs-5">{{ last_match.your_score }} - {{ last_match.opponent_score }}</strong>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Tournament Completion Status -->
                        {% if not current_player_context or not current_player_context.upcoming_matches %}
                        <div class="col-12 col-lg-6 mb-4">
                            <div class="neon-frame h-100">
                                <div class="card-header text-white" style="background: rgba(63, 86, 127, 0.2);">
                                    <h5 class="mb-0">
                                        <i class="fas fa-flag-checkered me-2"></i>Tournament Status
                                    </h5>
                                </div>
                                <div class="card-body text-center">
                                    {% if tournament.status == 'completed' %}
                                        <i class="fas fa-trophy fa-3x text-warning mb-3"></i>
                                        <h5 class="text-success">Tournament Complete!</h5>
                                        <p class="text-muted">All matches have been played.</p>
                                    {% elif current_player_context and current_player_context.player_status == 'Eliminated' %}
                                        <i class="fas fa-times-circle fa-3x text-danger mb-3"></i>
                                        <h5 class="text-danger">Eliminated</h5>
                                        <p class="text-muted">You've been eliminated from this tournament.</p>
                                    {% else %}
                                        <i class="fas fa-clock fa-3x text-info mb-3"></i>
                                        <h5 class="text-info">Awaiting Next Round</h5>
                                        <p class="text-muted">Waiting for other matches to complete.</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Your Upcoming Matches (Next 2) -->
                        {% if current_player_context and current_player_context.upcoming_matches %}
                        {% for match in current_player_context.upcoming_matches[:2] %}
                        <div class="col-12 col-lg-6 mb-4">
                            <div class="neon-frame h-100">
                                <div class="card-header text-white" style="background: rgba(63, 86, 127, 0.2);">
                                    <h5 class="mb-0">
                                        <i class="fas fa-calendar-alt me-2"></i>
                                        {% if loop.first %}Your Next Match{% else %}Following Match{% endif %}
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- Round Information -->
                                    <div class="text-center mb-3">
                                        <h6 class="text-primary">
                                            {% if match.round_number == max_rounds %}
                                                üèÜ Final Match
                                            {% elif match.round_number == max_rounds - 1 %}
                                                ü•à Semifinal Match
                                            {% elif match.round_number == max_rounds - 2 %}
                                                ü•â Quarterfinal Match
                                            {% else %}
                                                Round {{ match.round_number }}
                                            {% endif %}
                                        </h6>
                                    </div>

                                    <!-- Opponent Information -->
                                    {% if match.opponent_name %}
                                    <div class="row mb-3">
                                        <div class="col-12">
                                            <div class="text-center p-3 rounded" style="background: linear-gradient(135deg, rgba(63, 86, 127, 0.1) 0%, rgba(209, 116, 210, 0.1) 100%); border: 1px solid rgba(63, 86, 127, 0.3);">
                                                <div class="d-flex align-items-center justify-content-center mb-2">
                                                    <i class="fas fa-user-circle fa-2x me-3" style="color: var(--neon-purple);"></i>
                                                    <div class="text-start">
                                                        <h6 class="mb-1">{{ match.opponent_name }}</h6>
                                                        <small class="text-muted">{{ match.opponent_skill }} Level</small>
                                                    </div>
                                                </div>
                                                
                                                <!-- Opponent's Last Match Info -->
                                                {% if loop.first and current_player_context.next_opponent_last_match %}
                                                <div class="border-top pt-3 mt-3">
                                                    <h6 class="text-muted mb-2">
                                                        <i class="fas fa-history me-1"></i>Their Last Match
                                                    </h6>
                                                    <div class="row text-center">
                                                        <div class="col-4">
                                                            <div class="small text-muted">vs</div>
                                                            <div class="fw-bold small">{{ current_player_context.next_opponent_last_match.opponent_opponent_name or 'N/A' }}</div>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="small text-muted">Score</div>
                                                            <div class="fw-bold">
                                                                {{ current_player_context.next_opponent_last_match.next_opponent_score or '-' }}-{{ current_player_context.next_opponent_last_match.opponent_opponent_score or '-' }}
                                                            </div>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="small text-muted">Result</div>
                                                            <span class="badge {{ 'bg-success' if current_player_context.next_opponent_last_match.next_opponent_result == 'W' else 'bg-danger' }}">
                                                                {{ current_player_context.next_opponent_last_match.next_opponent_result or 'N/A' }}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% elif loop.first %}
                                                <div class="border-top pt-3 mt-3">
                                                    <small class="text-muted">
                                                        <i class="fas fa-info-circle me-1"></i>No previous match data available
                                                    </small>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% else %}
                                    <div class="text-center p-4">
                                        <i class="fas fa-question-circle fa-3x text-muted mb-3"></i>
                                        <h6 class="text-muted">Opponent TBD</h6>
                                        <small class="text-muted">Waiting for previous matches to complete</small>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                {% endif %}
                
                <!-- Navigation Breadcrumbs -->
                <nav aria-label="bracket navigation" class="mt-4">
                    <ol class="breadcrumb justify-content-center">
                        <li class="breadcrumb-item">
                            <a href="{{ url_for('player_home', player_id=current_player_id) }}" class="text-decoration-none">
                                <i class="fas fa-home me-1"></i>Dashboard
                            </a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="{{ url_for('tournaments_overview') }}" class="text-decoration-none">
                                <i class="fas fa-trophy me-1"></i>Tournaments
                            </a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            <i class="fas fa-sitemap me-1"></i>{{ tournament.name }} Bracket
                        </li>
                    </ol>
                </nav>
                
                <!-- Navigation Buttons -->
                <div class="d-flex flex-wrap justify-content-center gap-2 mt-3">
                    <a href="{{ url_for('tournaments_overview') }}" class="btn btn-primary">
                        <i class="fas fa-arrow-left me-2"></i>Back to Tournaments
                    </a>
                    <a href="{{ url_for('player_home', player_id=current_player_id) }}" class="btn btn-outline-primary">
                        <i class="fas fa-home me-2"></i>Dashboard
                    </a>
                    {% if tournament.status == 'open' and current_player_id and not player_entry %}
                    <a href="{{ url_for('quick_join_tournament', player_id=current_player_id) }}?level={{ tournament.skill_level }}" class="btn btn-success">
                        <i class="fas fa-plus me-2"></i>Join This Tournament
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
        /* ========================================
         * CLEAN TENNIS BRACKET STYLING - OVERRIDE
         * Simple, professional tournament bracket design
         * ======================================== */
        
        /* Reset and Override Complex Styles */
        .tennis-bracket-container,
        .tennis-bracket-container * {
            box-sizing: border-box;
        }
        
        /* Tennis Bracket Color System */
        :root {
            --tennis-bg: #0c0c19;
            --tennis-surface: #1a1a2e;
            --tennis-light: #ffffff;
            --tennis-text: #333333;
            --tennis-border: #e5e7eb;
            --tennis-hover: #f3f4f6;
            
            /* Ready 2 Dink Neon Colors */
            --neon-cyan: #00f5ff;
            --neon-green: #00ff41;
            --neon-purple: #bf00ff;
            
            /* Effects */
            --tennis-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --tennis-shadow-hover: 0 4px 16px rgba(0, 0, 0, 0.15);
            --neon-glow-cyan: 0 0 15px rgba(0, 245, 255, 0.6);
            --neon-glow-green: 0 0 15px rgba(0, 255, 65, 0.6);
            --neon-glow-purple: 0 0 15px rgba(191, 0, 255, 0.6);
            
            /* Spacing */
            --tennis-xs: 0.5rem;
            --tennis-sm: 0.75rem;
            --tennis-md: 1rem;
            --tennis-lg: 1.5rem;
            --tennis-xl: 2rem;
        }
        
        /* ========================================
         * TENNIS BRACKET CONTAINER
         * ======================================== */
        
        .tennis-bracket-container {
            margin: var(--tennis-lg) 0 !important;
            background: rgba(26, 26, 46, 0.3) !important;
            border-radius: 12px !important;
            padding: var(--tennis-lg) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            backdrop-filter: none !important;
            box-shadow: none !important;
        }
        
        .bracket-wrapper {
            width: 100% !important;
            overflow-x: auto !important;
            padding: var(--tennis-sm) !important;
        }
        
        /* ========================================
         * BRACKET ROUNDS LAYOUT
         * ======================================== */
        
        .bracket-rounds {
            display: flex !important;
            flex-direction: row !important;
            gap: var(--tennis-xl) !important;
            min-width: max-content !important;
            align-items: flex-start !important;
        }
        
        .round-column {
            display: flex !important;
            flex-direction: column !important;
            gap: var(--tennis-md) !important;
            min-width: 280px !important;
            position: relative !important;
        }
        
        /* ========================================
         * ROUND HEADERS
         * ======================================== */
        
        .round-header {
            text-align: center !important;
            margin-bottom: var(--tennis-md) !important;
            background: none !important;
            border: none !important;
            padding: 0 !important;
        }
        
        .round-title {
            color: var(--text-primary) !important;
            font-size: 1.25rem !important;
            font-weight: 700 !important;
            text-align: center !important;
            margin: 0 !important;
            text-shadow: 0 0 10px rgba(0, 245, 255, 0.5) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: var(--tennis-sm) !important;
            background: none !important;
            border: none !important;
            cursor: default !important;
        }
        
        /* ========================================
         * ROUND MATCHES
         * ======================================== */
        
        .round-matches {
            display: flex !important;
            flex-direction: column !important;
            gap: var(--tennis-lg) !important;
        }
        
        /* ========================================
         * GAME CONTAINERS & LABELS
         * ======================================== */
        
        .game-container {
            display: flex !important;
            flex-direction: column !important;
            gap: var(--tennis-sm) !important;
        }
        
        .game-label {
            text-align: center !important;
            margin-bottom: var(--tennis-xs) !important;
        }
        
        .game-number {
            background: var(--neon-cyan) !important;
            color: var(--tennis-bg) !important;
            padding: 0.25rem 0.75rem !important;
            border-radius: 6px !important;
            font-size: 0.875rem !important;
            font-weight: 700 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            box-shadow: var(--neon-glow-cyan) !important;
            display: inline-block !important;
        }
        
        /* ========================================
         * MATCH BOXES - Clean White Design
         * ======================================== */
        
        .match-box {
            background: var(--tennis-light) !important;
            border: 2px solid var(--tennis-border) !important;
            border-radius: 8px !important;
            padding: var(--tennis-md) !important;
            box-shadow: var(--tennis-shadow) !important;
            transition: all 0.2s ease !important;
            cursor: pointer !important;
            position: relative !important;
            backdrop-filter: none !important;
            min-height: auto !important;
        }
        
        .match-box:hover {
            border-color: var(--neon-cyan) !important;
            box-shadow: var(--tennis-shadow-hover), var(--neon-glow-cyan) !important;
            transform: translateY(-2px) !important;
        }
        
        /* Current Player Match Highlighting */
        .match-box.current-player-match {
            border-color: var(--neon-green) !important;
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.05), rgba(255, 255, 255, 0.95)) !important;
            box-shadow: var(--tennis-shadow), var(--neon-glow-green) !important;
        }
        
        /* Next Opponent Match Highlighting */
        .match-box.next-opponent-match {
            border-color: var(--neon-purple) !important;
            background: linear-gradient(135deg, rgba(191, 0, 255, 0.05), rgba(255, 255, 255, 0.95)) !important;
            box-shadow: var(--tennis-shadow), var(--neon-glow-purple) !important;
        }
        
        /* ========================================
         * PLAYER SLOTS
         * ======================================== */
        
        .player-slot {
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
            padding: var(--tennis-sm) !important;
            border-radius: 6px !important;
            margin-bottom: var(--tennis-xs) !important;
            transition: all 0.2s ease !important;
            background: transparent !important;
            border: none !important;
        }
        
        .player-slot:last-of-type {
            margin-bottom: 0 !important;
        }
        
        .player-slot.winner {
            background: rgba(0, 255, 65, 0.1) !important;
            border: 1px solid var(--neon-green) !important;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3) !important;
        }
        
        .player-info {
            display: flex !important;
            align-items: center !important;
            gap: var(--tennis-sm) !important;
            flex: 1 !important;
            min-width: 0 !important;
        }
        
        .player-photo,
        .player-photo-placeholder {
            width: 40px !important;
            height: 40px !important;
            border-radius: 50% !important;
            border: 2px solid var(--tennis-border) !important;
            flex-shrink: 0 !important;
        }
        
        .player-photo {
            object-fit: cover !important;
        }
        
        .player-photo-placeholder {
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple)) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: white !important;
            font-size: 1rem !important;
        }
        
        .player-name {
            color: var(--tennis-text) !important;
            font-size: 0.9rem !important;
            font-weight: 600 !important;
            text-overflow: ellipsis !important;
            overflow: hidden !important;
            white-space: nowrap !important;
            text-shadow: none !important;
        }
        
        .player-score {
            color: var(--tennis-text) !important;
            font-size: 1.125rem !important;
            font-weight: 700 !important;
            min-width: 30px !important;
            text-align: center !important;
            text-shadow: none !important;
        }
        
        .player-slot.winner .player-name,
        .player-slot.winner .player-score {
            color: var(--neon-green) !important;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5) !important;
        }
        
        /* ========================================
         * VS DIVIDER
         * ======================================== */
        
        .vs-divider {
            text-align: center !important;
            margin: var(--tennis-xs) 0 !important;
            position: relative !important;
        }
        
        .vs-divider span {
            background: var(--tennis-light) !important;
            color: var(--tennis-text) !important;
            padding: 0 var(--tennis-sm) !important;
            font-size: 0.75rem !important;
            font-weight: 700 !important;
            letter-spacing: 0.1em !important;
            position: relative !important;
            z-index: 1 !important;
        }
        
        .vs-divider::before {
            content: '' !important;
            position: absolute !important;
            top: 50% !important;
            left: 0 !important;
            right: 0 !important;
            height: 1px !important;
            background: var(--tennis-border) !important;
            z-index: 0 !important;
        }
        
        /* ========================================
         * MATCH STATUS INDICATORS
         * ======================================== */
        
        .match-status-indicator {
            text-align: center !important;
            margin-top: var(--tennis-sm) !important;
        }
        
        .status-badge {
            display: inline-flex !important;
            align-items: center !important;
            gap: 0.25rem !important;
            padding: 0.25rem 0.75rem !important;
            border-radius: 6px !important;
            font-size: 0.75rem !important;
            font-weight: 600 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
        }
        
        .status-badge.completed {
            background: rgba(0, 255, 65, 0.1) !important;
            color: var(--neon-green) !important;
            border: 1px solid var(--neon-green) !important;
        }
        
        .status-badge.live {
            background: rgba(255, 149, 0, 0.1) !important;
            color: #ff9500 !important;
            border: 1px solid #ff9500 !important;
        }
        
        .status-badge.pending {
            background: rgba(156, 163, 175, 0.1) !important;
            color: #6b7280 !important;
            border: 1px solid #6b7280 !important;
        }
        
        /* ========================================
         * ROUND CONNECTORS - Connecting Lines
         * ======================================== */
        
        .round-connector {
            position: absolute !important;
            top: 50% !important;
            right: calc(-1 * var(--tennis-xl) / 2) !important;
            transform: translateY(-50%) !important;
            z-index: 1 !important;
        }
        
        .connector-line {
            width: var(--tennis-xl) !important;
            height: 3px !important;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-purple)) !important;
            border-radius: 2px !important;
            box-shadow: var(--neon-glow-cyan) !important;
            position: relative !important;
        }
        
        .connector-line::before {
            content: '' !important;
            position: absolute !important;
            right: -8px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            width: 0 !important;
            height: 0 !important;
            border-left: 8px solid var(--neon-purple) !important;
            border-top: 6px solid transparent !important;
            border-bottom: 6px solid transparent !important;
            filter: drop-shadow(var(--neon-glow-purple)) !important;
        }
        
        /* ========================================
         * CHAMPIONSHIP DISPLAY
         * ======================================== */
        
        .championship-display {
            text-align: center !important;
            margin-top: var(--tennis-xl) !important;
            padding: var(--tennis-xl) !important;
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.1), rgba(191, 0, 255, 0.1)) !important;
            border-radius: 12px !important;
            border: 2px solid var(--neon-cyan) !important;
            box-shadow: var(--neon-glow-cyan) !important;
        }
        
        .trophy-container {
            max-width: 300px !important;
            margin: 0 auto !important;
        }
        
        .trophy-icon {
            font-size: 3rem !important;
            color: var(--neon-green) !important;
            text-shadow: var(--neon-glow-green) !important;
            margin-bottom: var(--tennis-md) !important;
            animation: trophyGlow 2s ease-in-out infinite alternate !important;
        }
        
        @keyframes trophyGlow {
            from { 
                filter: drop-shadow(0 0 10px rgba(0, 255, 65, 0.5)) !important;
            }
            to { 
                filter: drop-shadow(0 0 20px rgba(0, 255, 65, 0.8)) !important;
            }
        }
        
        .champion-title {
            color: var(--text-primary) !important;
            font-size: 1.5rem !important;
            font-weight: 700 !important;
            margin-bottom: var(--tennis-md) !important;
            text-shadow: var(--neon-glow-cyan) !important;
        }
        
        .champion-photo,
        .champion-photo-placeholder {
            width: 80px !important;
            height: 80px !important;
            border-radius: 50% !important;
            border: 3px solid var(--neon-green) !important;
            margin: 0 auto var(--tennis-sm) !important;
            box-shadow: var(--neon-glow-green) !important;
        }
        
        .champion-photo {
            object-fit: cover !important;
        }
        
        .champion-photo-placeholder {
            background: linear-gradient(135deg, var(--neon-green), var(--neon-cyan)) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: white !important;
            font-size: 2rem !important;
        }
        
        .champion-name {
            color: var(--text-primary) !important;
            font-size: 1.25rem !important;
            font-weight: 700 !important;
            margin-bottom: var(--tennis-sm) !important;
            text-shadow: var(--neon-glow-green) !important;
        }
        
        .final-score {
            color: var(--text-secondary) !important;
            font-size: 1rem !important;
            font-weight: 600 !important;
        }
        
        /* ========================================
         * MOBILE RESPONSIVE DESIGN
         * ======================================== */
        
        /* Mobile - Stack vertically */
        @media (max-width: 768px) {
            .bracket-rounds {
                flex-direction: column !important;
                gap: var(--tennis-lg) !important;
                align-items: stretch !important;
            }
            
            .round-column {
                min-width: 100% !important;
                width: 100% !important;
            }
            
            .round-connector {
                position: static !important;
                transform: none !important;
                text-align: center !important;
                margin: var(--tennis-md) 0 !important;
            }
            
            .connector-line {
                width: 50px !important;
                height: 3px !important;
                margin: 0 auto !important;
                transform: rotate(90deg) !important;
            }
            
            .connector-line::before {
                right: 50% !important;
                top: -8px !important;
                transform: translateX(50%) rotate(90deg) !important;
                border-left: 6px solid transparent !important;
                border-right: 6px solid transparent !important;
                border-top: 8px solid var(--neon-purple) !important;
                border-bottom: none !important;
            }
            
            .game-number {
                font-size: 0.75rem !important;
                padding: 0.2rem 0.5rem !important;
            }
            
            .match-box {
                padding: var(--tennis-sm) !important;
            }
            
            .player-photo,
            .player-photo-placeholder {
                width: 35px !important;
                height: 35px !important;
            }
            
            .player-name {
                font-size: 0.8rem !important;
            }
            
            .player-score {
                font-size: 1rem !important;
            }
        }
        
        /* Tablet */
        @media (min-width: 769px) and (max-width: 1024px) {
            .bracket-wrapper {
                overflow-x: auto !important;
            }
            
            .round-column {
                min-width: 250px !important;
            }
            
            .bracket-rounds {
                gap: var(--tennis-lg) !important;
            }
        }
        
        /* Large Desktop */
        @media (min-width: 1200px) {
            .round-column {
                min-width: 320px !important;
            }
            
            .bracket-rounds {
                gap: 3rem !important;
            }
            
            .connector-line {
                width: 3rem !important;
            }
        }

        /* ========================================
         * MOBILE-FIRST RESPONSIVE TOURNAMENT BRACKET
         * Custom Properties for Dynamic Theming
         * ======================================== */
        
        :root {
            /* Ready 2 Dink Neon Theme Colors */
            --bracket-cyan: #00f5ff;
            --bracket-green: #00ff41;
            --bracket-purple: #bf00ff;
            --bracket-dark-bg: #0c0c19;
            --bracket-surface: #1a1a2e;
            --bracket-accent: #2d2d4a;
            --bracket-glass: rgba(255, 255, 255, 0.05);
            --bracket-glass-border: rgba(255, 255, 255, 0.15);
            
            /* Dynamic spacing system */
            --bracket-gap-xs: 0.5rem;
            --bracket-gap-sm: 1rem;
            --bracket-gap-md: 1.5rem;
            --bracket-gap-lg: 2rem;
            --bracket-gap-xl: 3rem;
            
            /* Touch targets */
            --touch-target-min: 44px;
            --touch-target-comfort: 56px;
            
            /* Responsive typography */
            --bracket-text-xs: 0.75rem;
            --bracket-text-sm: 0.875rem;
            --bracket-text-base: 1rem;
            --bracket-text-lg: 1.125rem;
            --bracket-text-xl: 1.25rem;
            
            /* Animation timing */
            --bracket-transition-fast: 0.15s ease-out;
            --bracket-transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --bracket-transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Shadows and glows */
            --bracket-shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --bracket-shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
            --bracket-shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
            --bracket-glow-cyan: 0 0 20px rgba(0, 245, 255, 0.4);
            --bracket-glow-green: 0 0 20px rgba(0, 255, 65, 0.4);
            --bracket-glow-purple: 0 0 20px rgba(191, 0, 255, 0.4);
        }
        
        /* ========================================
         * BRACKET CONTAINER - MOBILE FIRST
         * ======================================== */
        
        .tournament-bracket-wrapper {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: 1rem;
            background: var(--bracket-surface);
            backdrop-filter: blur(20px);
            border: 1px solid var(--bracket-glass-border);
            box-shadow: var(--bracket-shadow-lg);
        }
        
        .bracket-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--bracket-gap-sm);
            background: linear-gradient(135deg, var(--bracket-cyan) 0%, var(--bracket-purple) 100%);
            border-radius: 1rem 1rem 0 0;
            margin-bottom: var(--bracket-gap-sm);
        }
        
        .bracket-zoom-controls {
            display: flex;
            gap: var(--bracket-gap-xs);
        }
        
        .bracket-zoom-btn {
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: var(--bracket-text-lg);
            cursor: pointer;
            transition: var(--bracket-transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }
        
        .bracket-zoom-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .find-me-btn {
            padding: 0.5rem 1rem;
            background: var(--bracket-green);
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: var(--bracket-text-sm);
            cursor: pointer;
            transition: var(--bracket-transition-normal);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            min-height: var(--touch-target-min);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            touch-action: manipulation;
        }
        
        .find-me-btn:hover {
            background: var(--bracket-purple);
            box-shadow: var(--bracket-glow-purple);
            transform: translateY(-2px);
        }
        
        .bracket-container {
            position: relative;
            width: 100%;
            min-height: 400px;
            max-height: 80vh;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
            touch-action: pan-y pinch-zoom;
            transform-origin: center center;
            transition: transform var(--bracket-transition-normal);
        }
        
        .bracket-viewport {
            /* Mobile-first: Vertical stacking */
            display: flex;
            flex-direction: column;
            gap: var(--bracket-gap-lg);
            padding: var(--bracket-gap-sm);
            width: 100%;
            transform-origin: 0 0;
            will-change: transform;
        }
        
        /* ========================================
         * ROUND SYSTEM - MOBILE FIRST
         * ======================================== */
        
        .round-section {
            background: var(--bracket-glass);
            border: 1px solid var(--bracket-glass-border);
            border-radius: 1rem;
            padding: var(--bracket-gap-sm);
            backdrop-filter: blur(10px);
            transition: var(--bracket-transition-normal);
        }
        
        .round-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--bracket-gap-sm);
            background: linear-gradient(135deg, var(--bracket-cyan) 0%, var(--bracket-green) 100%);
            border-radius: 0.75rem;
            margin-bottom: var(--bracket-gap-sm);
            cursor: pointer;
            touch-action: manipulation;
            min-height: var(--touch-target-comfort);
        }
        
        .round-title {
            color: white;
            font-weight: 700;
            font-size: var(--bracket-text-lg);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            margin: 0;
        }
        
        .round-toggle {
            color: white;
            font-size: var(--bracket-text-xl);
            transition: var(--bracket-transition-fast);
            transform-origin: center;
        }
        
        .round-section.collapsed .round-toggle {
            transform: rotate(-90deg);
        }
        
        .matches-grid {
            display: grid;
            gap: var(--bracket-gap-sm);
            grid-template-columns: 1fr;
            transition: var(--bracket-transition-normal);
            overflow: hidden;
        }
        
        .round-section.collapsed .matches-grid {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
        }
        
        /* ========================================
         * MATCH CARDS - MOBILE OPTIMIZED
         * ======================================== */
        
        .match-card {
            background: var(--bracket-surface);
            border: 2px solid var(--bracket-glass-border);
            border-radius: 1rem;
            padding: var(--bracket-gap-sm);
            transition: var(--bracket-transition-normal);
            cursor: pointer;
            touch-action: manipulation;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            min-height: var(--touch-target-comfort);
        }
        
        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--bracket-cyan), var(--bracket-green), var(--bracket-purple));
            opacity: 0;
            transition: var(--bracket-transition-normal);
        }
        
        .match-card:hover::before,
        .match-card:focus::before {
            opacity: 1;
        }
        
        .match-card:hover,
        .match-card:focus {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--bracket-shadow-lg), var(--bracket-glow-cyan);
            border-color: var(--bracket-cyan);
            z-index: 10;
        }
        
        /* Player Match Highlighting with Pulsing Animation */
        .player-match {
            border-color: var(--bracket-green);
            box-shadow: var(--bracket-glow-green);
            animation: playerPulse 2s ease-in-out infinite;
            position: relative;
        }
        
        .player-match::after {
            content: 'üë§ YOU';
            position: absolute;
            top: -0.5rem;
            right: -0.5rem;
            background: var(--bracket-green);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: var(--bracket-text-xs);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            box-shadow: var(--bracket-shadow-sm);
            z-index: 5;
        }
        
        @keyframes playerPulse {
            0%, 100% {
                box-shadow: var(--bracket-glow-green);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 30px rgba(0, 255, 65, 0.6), 0 0 60px rgba(0, 255, 65, 0.3);
                transform: scale(1.01);
            }
        }
        
        /* ========================================
         * PLAYER ROWS - ENHANCED MOBILE DESIGN
         * ======================================== */
        
        .player-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--bracket-gap-xs);
            border-radius: 0.5rem;
            transition: var(--bracket-transition-fast);
            min-height: var(--touch-target-min);
            touch-action: manipulation;
        }
        
        .player-row.winner {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.2), rgba(0, 245, 255, 0.1));
            border: 1px solid var(--bracket-green);
            font-weight: 700;
            animation: winnerGlow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes winnerGlow {
            from {
                box-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
            }
            to {
                box-shadow: 0 0 15px rgba(0, 255, 65, 0.6);
            }
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: var(--bracket-gap-xs);
            flex: 1;
            min-width: 0;
        }
        
        .player-avatar {
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--bracket-glass-border);
            transition: var(--bracket-transition-fast);
            flex-shrink: 0;
        }
        
        .player-avatar:hover {
            border-color: var(--bracket-cyan);
            box-shadow: var(--bracket-glow-cyan);
        }
        
        .player-avatar-placeholder {
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            border-radius: 50%;
            background: linear-gradient(135deg, var(--bracket-accent), var(--bracket-surface));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--bracket-text-lg);
            color: var(--bracket-glass-border);
            border: 2px solid var(--bracket-glass-border);
            flex-shrink: 0;
        }
        
        .player-name {
            font-size: var(--bracket-text-base);
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .match-score {
            font-weight: 700;
            font-size: var(--bracket-text-lg);
            color: var(--bracket-cyan);
            text-shadow: 0 0 10px currentColor;
            min-width: 2rem;
            text-align: center;
        }
        
        .match-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--bracket-glass-border), transparent);
            margin: var(--bracket-gap-xs) 0;
        }
        
        /* ========================================
         * MATCH STATUS INDICATORS
         * ======================================== */
        
        .match-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: var(--bracket-gap-xs);
            padding: 0.25rem;
            border-radius: 0.5rem;
            font-size: var(--bracket-text-xs);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .match-status.completed {
            background: linear-gradient(135deg, var(--bracket-green), rgba(0, 255, 65, 0.8));
            color: white;
        }
        
        .match-status.in_progress {
            background: linear-gradient(135deg, #ff9500, rgba(255, 149, 0, 0.8));
            color: white;
            animation: progressPulse 1s ease-in-out infinite;
        }
        
        .match-status.pending {
            background: var(--bracket-glass);
            color: var(--bracket-glass-border);
            border: 1px solid var(--bracket-glass-border);
        }
        
        @keyframes progressPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .match-result-display {
            margin-top: 0.5rem;
        }
        
        .match-result-badge {
            background: var(--bracket-green);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: var(--bracket-text-xs);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            box-shadow: var(--bracket-shadow-sm);
        }
        
        /* ========================================
         * LOADING STATES & SKELETONS
         * ======================================== */
        
        .bracket-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 50vh;
            gap: var(--bracket-gap-md);
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--bracket-glass-border);
            border-top: 3px solid var(--bracket-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .skeleton-match {
            background: linear-gradient(90deg, var(--bracket-glass) 25%, rgba(255,255,255,0.1) 50%, var(--bracket-glass) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 1rem;
            height: 120px;
            margin-bottom: var(--bracket-gap-sm);
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .pull-refresh-indicator {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bracket-surface);
            padding: var(--bracket-gap-sm);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: var(--bracket-gap-xs);
            color: white;
            font-size: var(--bracket-text-sm);
            z-index: 100;
            transition: var(--bracket-transition-normal);
        }
        
        /* ========================================
         * FLOATING ACTION BUTTONS
         * ======================================== */
        
        .bracket-fab-container {
            position: fixed;
            bottom: var(--bracket-gap-lg);
            right: var(--bracket-gap-lg);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: var(--bracket-gap-sm);
        }
        
        .bracket-fab {
            width: var(--touch-target-comfort);
            height: var(--touch-target-comfort);
            border-radius: 50%;
            background: linear-gradient(135deg, var(--bracket-cyan), var(--bracket-purple));
            border: none;
            color: white;
            font-size: var(--bracket-text-lg);
            cursor: pointer;
            transition: var(--bracket-transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--bracket-shadow-md), var(--bracket-glow-cyan);
            touch-action: manipulation;
        }
        
        .bracket-fab:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: var(--bracket-shadow-lg), var(--bracket-glow-purple);
        }
        
        /* ========================================
         * RESPONSIVE BREAKPOINTS
         * ======================================== */
         
        /* Extra small devices (phones, 320px to 575px) */
        @media (max-width: 575px) {
            .tournament-bracket-wrapper {
                margin: 0;
                border-radius: 0.5rem;
            }
            
            .bracket-container {
                min-height: 350px;
                max-height: 70vh;
            }
            
            .bracket-viewport {
                padding: var(--bracket-gap-xs);
                gap: var(--bracket-gap-md);
            }
            
            .round-section {
                border-radius: 0.75rem;
                padding: var(--bracket-gap-xs);
            }
            
            .round-header {
                padding: var(--bracket-gap-xs);
                min-height: var(--touch-target-comfort);
            }
            
            .round-title {
                font-size: var(--bracket-text-base);
            }
            
            .match-card {
                padding: var(--bracket-gap-xs);
                min-height: auto;
            }
            
            .player-avatar,
            .player-avatar-placeholder {
                width: 32px;
                height: 32px;
            }
            
            .player-name {
                font-size: var(--bracket-text-sm);
            }
            
            .match-score {
                font-size: var(--bracket-text-base);
            }
            
            /* Optimize controls for small screens */
            .bracket-controls {
                padding: var(--bracket-gap-xs);
                flex-wrap: wrap;
                gap: var(--bracket-gap-xs);
            }
            
            .bracket-zoom-controls {
                flex-wrap: wrap;
            }
            
            .find-me-btn {
                font-size: var(--bracket-text-xs);
                padding: 0.375rem 0.75rem;
            }
        }
        
        /* Small devices (landscape phones, 576px and up) */
        @media (min-width: 576px) {
            .bracket-viewport {
                gap: var(--bracket-gap-xl);
            }
            
            .matches-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
            
            .bracket-controls {
                padding: var(--bracket-gap-md);
            }
        }
        
        /* Medium devices (tablets, 768px and up) */
        @media (min-width: 768px) {
            .bracket-viewport {
                /* Keep vertical layout on tablets to prevent overflow */
                flex-direction: column;
                gap: var(--bracket-gap-lg);
                padding: var(--bracket-gap-md);
            }
            
            .round-section {
                width: 100%;
                max-width: none;
            }
            
            .matches-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: var(--bracket-gap-md);
            }
            
            .bracket-container {
                min-height: 500px;
                max-height: 85vh;
            }
            
            :root {
                --bracket-text-base: 1.125rem;
                --bracket-text-lg: 1.25rem;
                --bracket-text-xl: 1.5rem;
            }
        }
        
        /* Large devices (desktops, 1024px and up) */
        @media (min-width: 1024px) {
            :root {
                --bracket-connector-width: 3px;
                --bracket-connector-height: 60px;
            }
            
            .bracket-viewport {
                flex-direction: row;
                gap: var(--bracket-gap-xl);
                padding: var(--bracket-gap-lg);
                overflow-x: auto;
                overflow-y: hidden;
            }
            
            .round-section {
                flex: 0 0 auto;
                width: 350px;
                max-width: 400px;
                position: relative;
            }
            
            /* Add connectors between rounds on desktop */
            .round-section:not(:last-child)::after {
                content: '';
                position: absolute;
                top: 50%;
                right: calc(-1 * var(--bracket-gap-xl) / 2 - var(--bracket-connector-width) / 2);
                width: var(--bracket-connector-width);
                height: var(--bracket-connector-height);
                background: linear-gradient(135deg, var(--bracket-cyan), var(--bracket-green));
                border-radius: var(--bracket-connector-width);
                transform: translateY(-50%);
                box-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
                z-index: 1;
            }
            
            .match-card {
                padding: var(--bracket-gap-md);
                transition: var(--bracket-transition-normal);
            }
            
            .match-card:hover {
                transform: translateY(-4px) scale(1.02);
                box-shadow: var(--bracket-shadow-lg), var(--bracket-glow-cyan);
            }
            
            .bracket-container {
                min-height: 600px;
                max-height: 90vh;
            }
            
            .round-header {
                cursor: default; /* Less emphasis on collapsing on desktop */
            }
            
            .round-toggle {
                opacity: 0.5; /* Reduce visibility on desktop */
            }
            
            /* Desktop bracket fab positioning */
            .bracket-fab-container {
                position: fixed;
                top: 50%;
                right: 2rem;
                transform: translateY(-50%);
                z-index: 100;
            }
            
            .bracket-fab {
                width: 56px;
                height: 56px;
                font-size: 1.25rem;
            }
            
            /* Enhanced zoom controls for desktop */
            .bracket-zoom-btn {
                width: 48px;
                height: 48px;
                font-size: 1.25rem;
                transition: var(--bracket-transition-normal);
            }
            
            .bracket-zoom-btn:hover {
                background: rgba(255, 255, 255, 0.4);
                transform: scale(1.1);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }
        }
        
        /* Extra large devices (large desktops, 1200px and up) */
        @media (min-width: 1200px) {
            .bracket-viewport {
                justify-content: center;
                align-items: flex-start;
            }
            
            .round-section {
                min-width: 400px;
                max-width: 500px;
            }
            
            .match-card {
                padding: 2rem;
                border-radius: 1.5rem;
            }
            
            .player-avatar {
                width: 50px;
                height: 50px;
            }
            
            .player-avatar-placeholder {
                width: 50px;
                height: 50px;
            }
            
            .player-name {
                font-size: var(--bracket-text-lg);
                font-weight: 600;
            }
            
            .match-score {
                font-size: var(--bracket-text-xl);
                font-weight: 700;
            }
            
            :root {
                --bracket-text-base: 1.25rem;
                --bracket-text-lg: 1.375rem;
                --bracket-text-xl: 1.625rem;
            }
        }
        
        /* Ultra-wide desktop (for large tournaments, 1440px and up) */
        @media (min-width: 1440px) {
            .bracket-viewport {
                gap: 4rem;
            }
            
            .round-section {
                width: 400px;
                max-width: 500px;
            }
            
            /* Enhanced connectors for ultra-wide */
            .round-section:not(:last-child)::after {
                right: calc(-2rem - var(--bracket-connector-width) / 2);
                height: 80px;
                width: 4px;
                border-radius: 4px;
            }
        }
        
        /* Performance optimizations for low-end devices */
        @media (max-width: 768px) and (max-height: 1024px) {
            /* Reduce effects on mobile for better performance */
            .tournament-bracket-wrapper,
            .bracket-container,
            .match-card {
                backdrop-filter: none;
            }
            
            .match-card:hover {
                transform: none;
            }
            
            .bracket-fab:hover {
                transform: scale(1.05);
            }
        }
        
        /* Additional mobile viewport optimizations */
        @media (max-width: 768px) {
            /* Ensure no horizontal overflow on any mobile device */
            body {
                overflow-x: hidden;
            }
            
            .tournament-bracket-wrapper {
                overflow-x: hidden;
            }
            
            .bracket-viewport {
                overflow-x: hidden;
            }
            
            /* Improve touch targets on mobile */
            .match-card {
                min-height: var(--touch-target-min);
                touch-action: manipulation;
            }
            
            .round-header {
                touch-action: manipulation;
            }
            
            /* Optimize fab positioning for mobile */
            .bracket-fab-container {
                bottom: 1rem;
                right: 1rem;
                position: fixed;
                z-index: 100;
            }
            
            .bracket-fab {
                margin-bottom: var(--bracket-gap-xs);
            }
        }
        
        /* ========================================
         * ACCESSIBILITY ENHANCEMENTS
         * ======================================== */
        
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Focus management */
        .match-card:focus,
        .bracket-fab:focus,
        .find-me-btn:focus,
        .bracket-zoom-btn:focus {
            outline: 3px solid var(--bracket-cyan);
            outline-offset: 2px;
        }
        
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --bracket-glass: rgba(255, 255, 255, 0.15);
                --bracket-glass-border: rgba(255, 255, 255, 0.5);
            }
            
            .match-card {
                border-width: 3px;
            }
        }
        
        /* Dark mode preference (additional darkening) */
        @media (prefers-color-scheme: dark) {
            :root {
                --bracket-dark-bg: #050510;
                --bracket-surface: #0f0f1a;
            }
        }
</style>

<script>
    // ========================================
    // COMPREHENSIVE MOBILE BRACKET INTERACTIONS
    // ========================================
    
    class TournamentBracket {
        constructor() {
            this.currentZoom = 1;
            this.minZoom = 0.5;
            this.maxZoom = 3;
            this.isDragging = false;
            this.startX = 0;
            this.startY = 0;
            this.translateX = 0;
            this.translateY = 0;
            this.pullStartY = 0;
            this.isPulling = false;
            
            this.viewport = document.getElementById('bracketViewport');
            this.container = document.getElementById('bracketContainer');
            this.loading = document.getElementById('bracketLoading');
            this.pullRefreshIndicator = document.getElementById('pullRefreshIndicator');
            
            this.init();
        }
        
        init() {
            this.setupZoomControls();
            this.setupTouchInteractions();
            this.setupFindMe();
            this.setupFloatingButtons();
            this.setupKeyboardNavigation();
            this.setupPullToRefresh();
            this.setupSwipeNavigation();
            this.optimizeScrolling();
            
            // Auto-hide loading on page load
            setTimeout(() => {
                this.hideLoading();
            }, 500);
        }
        
        // ========================================
        // ZOOM FUNCTIONALITY
        // ========================================
        
        setupZoomControls() {
            const zoomIn = document.getElementById('zoomIn');
            const zoomOut = document.getElementById('zoomOut');
            const resetZoom = document.getElementById('resetZoom');
            
            if (zoomIn) zoomIn.addEventListener('click', () => this.zoom(1.2));
            if (zoomOut) zoomOut.addEventListener('click', () => this.zoom(0.8));
            if (resetZoom) resetZoom.addEventListener('click', () => this.resetZoom());
        }
        
        zoom(factor) {
            const newZoom = this.currentZoom * factor;
            if (newZoom >= this.minZoom && newZoom <= this.maxZoom) {
                this.currentZoom = newZoom;
                this.updateViewportTransform();
            }
        }
        
        resetZoom() {
            this.currentZoom = 1;
            this.translateX = 0;
            this.translateY = 0;
            this.updateViewportTransform();
        }
        
        updateViewportTransform() {
            if (this.viewport) {
                this.viewport.style.transform = 
                    `scale(${this.currentZoom}) translate(${this.translateX}px, ${this.translateY}px)`;
            }
        }
        
        // ========================================
        // TOUCH INTERACTIONS & GESTURES
        // ========================================
        
        setupTouchInteractions() {
            if (!this.container) return;
            
            let lastTouchDistance = 0;
            let lastTouchCenter = { x: 0, y: 0 };
            
            // Touch start
            this.container.addEventListener('touchstart', (e) => {
                if (e.touches.length === 1) {
                    // Single touch - start dragging
                    this.isDragging = true;
                    this.startX = e.touches[0].clientX - this.translateX;
                    this.startY = e.touches[0].clientY - this.translateY;
                } else if (e.touches.length === 2) {
                    // Pinch gesture start
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    
                    lastTouchDistance = this.getDistance(touch1, touch2);
                    lastTouchCenter = this.getCenter(touch1, touch2);
                }
            }, { passive: false });
            
            // Touch move
            this.container.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && this.isDragging) {
                    // Single touch - dragging
                    e.preventDefault();
                    this.translateX = e.touches[0].clientX - this.startX;
                    this.translateY = e.touches[0].clientY - this.startY;
                    this.updateViewportTransform();
                } else if (e.touches.length === 2) {
                    // Pinch gesture
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    
                    const distance = this.getDistance(touch1, touch2);
                    const center = this.getCenter(touch1, touch2);
                    
                    if (lastTouchDistance > 0) {
                        const scale = distance / lastTouchDistance;
                        const newZoom = this.currentZoom * scale;
                        
                        if (newZoom >= this.minZoom && newZoom <= this.maxZoom) {
                            this.currentZoom = newZoom;
                            
                            // Adjust translation to zoom towards touch center
                            const deltaX = center.x - lastTouchCenter.x;
                            const deltaY = center.y - lastTouchCenter.y;
                            this.translateX += deltaX;
                            this.translateY += deltaY;
                            
                            this.updateViewportTransform();
                        }
                    }
                    
                    lastTouchDistance = distance;
                    lastTouchCenter = center;
                }
            }, { passive: false });
            
            // Touch end
            this.container.addEventListener('touchend', () => {
                this.isDragging = false;
                lastTouchDistance = 0;
            });
            
            // Mouse events for desktop
            this.setupMouseInteractions();
        }
        
        setupMouseInteractions() {
            if (!this.container) return;
            
            this.container.addEventListener('wheel', (e) => {
                if (e.ctrlKey) {
                    // Zoom with Ctrl+scroll
                    e.preventDefault();
                    const scale = e.deltaY > 0 ? 0.9 : 1.1;
                    this.zoom(scale);
                }
            }, { passive: false });
            
            // Mouse drag
            this.container.addEventListener('mousedown', (e) => {
                if (e.button === 0) { // Left click
                    this.isDragging = true;
                    this.startX = e.clientX - this.translateX;
                    this.startY = e.clientY - this.translateY;
                    this.container.style.cursor = 'grabbing';
                }
            });
            
            this.container.addEventListener('mousemove', (e) => {
                if (this.isDragging) {
                    this.translateX = e.clientX - this.startX;
                    this.translateY = e.clientY - this.startY;
                    this.updateViewportTransform();
                }
            });
            
            this.container.addEventListener('mouseup', () => {
                this.isDragging = false;
                this.container.style.cursor = 'grab';
            });
            
            this.container.addEventListener('mouseleave', () => {
                this.isDragging = false;
                this.container.style.cursor = 'grab';
            });
        }
        
        getDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        getCenter(touch1, touch2) {
            return {
                x: (touch1.clientX + touch2.clientX) / 2,
                y: (touch1.clientY + touch2.clientY) / 2
            };
        }
        
        // ========================================
        // FIND ME FUNCTIONALITY
        // ========================================
        
        setupFindMe() {
            const findMeBtn = document.getElementById('findMe');
            if (findMeBtn) {
                findMeBtn.addEventListener('click', () => this.scrollToPlayerMatch());
            }
        }
        
        scrollToPlayerMatch() {
            const playerMatch = document.querySelector('.player-match');
            if (playerMatch) {
                // Add pulse effect
                playerMatch.style.animation = 'none';
                setTimeout(() => {
                    playerMatch.style.animation = 'playerPulse 1s ease-in-out 3';
                }, 10);
                
                // Smooth scroll to match
                playerMatch.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center',
                    inline: 'center'
                });
                
                // Show notification
                this.showNotification('üèÜ Found your match!', 'success');
            } else {
                this.showNotification('üîç No active matches found', 'info');
            }
        }
        
        // ========================================
        // FLOATING ACTION BUTTONS
        // ========================================
        
        setupFloatingButtons() {
            const showMyPath = document.getElementById('showMyPath');
            const fullscreenToggle = document.getElementById('fullscreenToggle');
            const refreshBracket = document.getElementById('refreshBracket');
            
            if (showMyPath) {
                showMyPath.addEventListener('click', () => this.highlightPlayerPath());
            }
            
            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', () => this.toggleFullscreen());
            }
            
            if (refreshBracket) {
                refreshBracket.addEventListener('click', () => this.refreshBracket());
            }
        }
        
        highlightPlayerPath() {
            const playerMatches = document.querySelectorAll('.player-match');
            const playerRows = document.querySelectorAll('[data-player-id]');
            
            // Clear previous highlights
            document.querySelectorAll('.path-highlight').forEach(el => {
                el.classList.remove('path-highlight');
            });
            
            // Add path highlighting
            playerMatches.forEach(match => {
                match.classList.add('path-highlight');
            });
            
            playerRows.forEach(row => {
                if (row.closest('.player-match')) {
                    row.style.background = 'linear-gradient(135deg, rgba(0, 255, 65, 0.3), rgba(0, 245, 255, 0.2))';
                }
            });
            
            this.showNotification('‚ú® Highlighted your tournament path', 'success');
        }
        
        toggleFullscreen() {
            const bracket = document.querySelector('.tournament-bracket-wrapper');
            
            if (!document.fullscreenElement) {
                bracket.requestFullscreen().catch(err => {
                    console.log('Fullscreen failed:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }
        
        refreshBracket() {
            this.showLoading();
            
            // Simulate refresh delay
            setTimeout(() => {
                this.hideLoading();
                this.showNotification('‚öôÔ∏è Bracket refreshed!', 'success');
                
                // You can add actual refresh logic here
                // window.location.reload();
            }, 1500);
        }
        
        // ========================================
        // ROUND TOGGLE FUNCTIONALITY
        // ========================================
        
        toggleRound(roundNum) {
            const roundSection = document.querySelector(`[data-round="${roundNum}"]`);
            if (roundSection) {
                roundSection.classList.toggle('collapsed');
                
                // Update localStorage for persistence
                const collapsedRounds = JSON.parse(localStorage.getItem('collapsedRounds') || '[]');
                if (roundSection.classList.contains('collapsed')) {
                    if (!collapsedRounds.includes(roundNum)) {
                        collapsedRounds.push(roundNum);
                    }
                } else {
                    const index = collapsedRounds.indexOf(roundNum);
                    if (index > -1) {
                        collapsedRounds.splice(index, 1);
                    }
                }
                localStorage.setItem('collapsedRounds', JSON.stringify(collapsedRounds));
            }
        }
        
        // Restore collapsed state on load
        restoreRoundStates() {
            const collapsedRounds = JSON.parse(localStorage.getItem('collapsedRounds') || '[]');
            collapsedRounds.forEach(roundNum => {
                const roundSection = document.querySelector(`[data-round="${roundNum}"]`);
                if (roundSection) {
                    roundSection.classList.add('collapsed');
                }
            });
        }
        
        // ========================================
        // MATCH DETAIL FUNCTIONALITY
        // ========================================
        
        showMatchDetails(matchId) {
            // Find the match element
            const matchCard = document.querySelector(`[data-match-id="${matchId}"]`);
            if (!matchCard) return;
            
            // Create modal or overlay for match details
            const modal = document.createElement('div');
            modal.className = 'match-detail-modal';
            modal.innerHTML = `
                <div class="match-detail-content">
                    <div class="match-detail-header">
                        <h3>üèÜ Match Details</h3>
                        <button class="close-modal" onclick="this.parentElement.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="match-detail-body">
                        ${matchCard.innerHTML}
                        <div class="match-extra-info">
                            <p><strong>Match ID:</strong> ${matchId}</p>
                            <p><strong>Status:</strong> <span class="status-badge">Active</span></p>
                            <p><strong>Round:</strong> Current Round</p>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal styles
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                backdrop-filter: blur(10px);
            `;
            
            const content = modal.querySelector('.match-detail-content');
            content.style.cssText = `
                background: var(--bracket-surface);
                border-radius: 1rem;
                padding: 2rem;
                max-width: 90vw;
                max-height: 80vh;
                overflow-y: auto;
                border: 1px solid var(--bracket-glass-border);
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            `;
            
            document.body.appendChild(modal);
            
            // Close on outside click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        // ========================================
        // KEYBOARD NAVIGATION
        // ========================================
        
        setupKeyboardNavigation() {
            document.addEventListener('keydown', (e) => {
                // Zoom shortcuts
                if (e.ctrlKey && e.key === '=') {
                    e.preventDefault();
                    this.zoom(1.2);
                } else if (e.ctrlKey && e.key === '-') {
                    e.preventDefault();
                    this.zoom(0.8);
                } else if (e.ctrlKey && e.key === '0') {
                    e.preventDefault();
                    this.resetZoom();
                }
                
                // Find me shortcut
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    this.scrollToPlayerMatch();
                }
                
                // Refresh shortcut
                if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
                    e.preventDefault();
                    this.refreshBracket();
                }
            });
        }
        
        // ========================================
        // PULL TO REFRESH
        // ========================================
        
        setupPullToRefresh() {
            let startY = 0;
            let currentY = 0;
            let pullDistance = 0;
            const threshold = 100;
            
            this.container.addEventListener('touchstart', (e) => {
                if (this.container.scrollTop === 0) {
                    startY = e.touches[0].clientY;
                    this.isPulling = true;
                }
            });
            
            this.container.addEventListener('touchmove', (e) => {
                if (!this.isPulling) return;
                
                currentY = e.touches[0].clientY;
                pullDistance = currentY - startY;
                
                if (pullDistance > 0 && this.container.scrollTop === 0) {
                    e.preventDefault();
                    
                    if (this.pullRefreshIndicator) {
                        this.pullRefreshIndicator.style.transform = `translateY(${Math.min(pullDistance, threshold)}px)`;
                        
                        if (pullDistance >= threshold) {
                            this.pullRefreshIndicator.classList.remove('d-none');
                        }
                    }
                }
            });
            
            this.container.addEventListener('touchend', () => {
                if (this.isPulling && pullDistance >= threshold) {
                    this.refreshBracket();
                }
                
                this.isPulling = false;
                pullDistance = 0;
                
                if (this.pullRefreshIndicator) {
                    this.pullRefreshIndicator.style.transform = '';
                    setTimeout(() => {
                        this.pullRefreshIndicator.classList.add('d-none');
                    }, 300);
                }
            });
        }
        
        // ========================================
        // SWIPE NAVIGATION
        // ========================================
        
        setupSwipeNavigation() {
            let startX = 0;
            let startY = 0;
            let isHorizontalSwipe = false;
            
            this.viewport.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                isHorizontalSwipe = false;
            });
            
            this.viewport.addEventListener('touchmove', (e) => {
                if (!startX || !startY) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;
                const diffX = startX - currentX;
                const diffY = startY - currentY;
                
                // Determine if this is a horizontal swipe
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    isHorizontalSwipe = true;
                }
            });
            
            this.viewport.addEventListener('touchend', (e) => {
                if (!startX || !startY || !isHorizontalSwipe) return;
                
                const endX = e.changedTouches[0].clientX;
                const diffX = startX - endX;
                
                // Navigate between rounds with swipe
                if (Math.abs(diffX) > 100) {
                    if (diffX > 0) {
                        this.navigateToNextRound();
                    } else {
                        this.navigateToPreviousRound();
                    }
                }
                
                startX = 0;
                startY = 0;
                isHorizontalSwipe = false;
            });
        }
        
        navigateToNextRound() {
            const rounds = document.querySelectorAll('.round-section:not(.collapsed)');
            if (rounds.length > 0) {
                const nextRound = rounds[Math.min(this.currentRoundIndex + 1, rounds.length - 1)];
                nextRound.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        navigateToPreviousRound() {
            const rounds = document.querySelectorAll('.round-section:not(.collapsed)');
            if (rounds.length > 0) {
                const prevRound = rounds[Math.max(this.currentRoundIndex - 1, 0)];
                prevRound.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // ========================================
        // PERFORMANCE OPTIMIZATIONS
        // ======================================== 
        
        optimizeScrolling() {
            // Enable GPU acceleration
            if (this.container) {
                this.container.style.transform = 'translate3d(0,0,0)';
                this.container.style.willChange = 'scroll-position';
            }
            
            // Throttle scroll events
            let scrollTimeout;
            this.container?.addEventListener('scroll', () => {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    // Update visible matches for virtual scrolling
                    this.updateVisibleMatches();
                }, 16); // ~60fps
            });
        }
        
        updateVisibleMatches() {
            const containerRect = this.container.getBoundingClientRect();
            const matches = document.querySelectorAll('.match-card');
            
            matches.forEach(match => {
                const matchRect = match.getBoundingClientRect();
                const isVisible = (
                    matchRect.bottom >= containerRect.top &&
                    matchRect.top <= containerRect.bottom
                );
                
                // Toggle visibility for performance
                if (isVisible) {
                    match.style.visibility = 'visible';
                } else {
                    match.style.visibility = 'hidden';
                }
            });
        }
        
        // ========================================
        // UTILITY FUNCTIONS
        // ========================================
        
        showLoading() {
            if (this.loading) {
                this.loading.classList.remove('d-none');
            }
        }
        
        hideLoading() {
            if (this.loading) {
                this.loading.classList.add('d-none');
            }
        }
        
        showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `bracket-notification ${type}`;
            notification.textContent = message;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--bracket-surface);
                color: white;
                padding: 1rem 2rem;
                border-radius: 0.5rem;
                border: 1px solid var(--bracket-glass-border);
                box-shadow: var(--bracket-shadow-lg);
                z-index: 1001;
                font-weight: 600;
                backdrop-filter: blur(10px);
                animation: slideInFromTop 0.3s ease-out;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutToTop 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    }
    
    // ========================================
    // TOURNAMENT BRACKET CONTROLLER CLASS
    // ========================================
    
    class TournamentBracketController {
        constructor() {
            this.container = document.getElementById('bracketContainer');
            this.viewport = document.getElementById('bracketViewport');
            this.loading = document.getElementById('bracketLoading');
            this.pullRefreshIndicator = document.getElementById('pullRefreshIndicator');
            
            // State management
            this.currentZoom = 1;
            this.minZoom = 0.5;
            this.maxZoom = 3;
            this.translateX = 0;
            this.translateY = 0;
            this.isDragging = false;
            this.isPulling = false;
            this.startX = 0;
            this.startY = 0;
            this.currentRoundIndex = 0;
            
            // Performance optimization flags
            this.isReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            this.isMobile = window.innerWidth <= 768 || 'ontouchstart' in window;
            
            this.init();
        }
        
        init() {
            if (!this.container || !this.viewport) {
                console.warn('Bracket elements not found');
                return;
            }
            
            this.setupZoomControls();
            this.setupTouchInteractions();
            this.setupFindMe();
            this.setupFloatingButtons();
            this.setupKeyboardNavigation();
            this.setupPullToRefresh();
            this.setupSwipeNavigation();
            this.optimizePerformance();
            this.restoreRoundStates();
            
            // Set initial cursor for draggable area
            this.container.style.cursor = 'grab';
        }
        
        // ========================================
        // ZOOM CONTROLS
        // ========================================
        
        setupZoomControls() {
            const zoomIn = document.getElementById('zoomIn');
            const zoomOut = document.getElementById('zoomOut');
            const resetZoom = document.getElementById('resetZoom');
            
            if (zoomIn) zoomIn.addEventListener('click', () => this.zoom(1.2));
            if (zoomOut) zoomOut.addEventListener('click', () => this.zoom(0.8));
            if (resetZoom) resetZoom.addEventListener('click', () => this.resetZoom());
        }
        
        zoom(factor) {
            const newZoom = this.currentZoom * factor;
            if (newZoom >= this.minZoom && newZoom <= this.maxZoom) {
                this.currentZoom = newZoom;
                this.updateViewportTransform();
            }
        }
        
        resetZoom() {
            this.currentZoom = 1;
            this.translateX = 0;
            this.translateY = 0;
            this.updateViewportTransform();
        }
        
        updateViewportTransform() {
            if (this.viewport) {
                this.viewport.style.transform = 
                    `scale(${this.currentZoom}) translate(${this.translateX}px, ${this.translateY}px)`;
            }
        }
        
        // ========================================
        // TOUCH INTERACTIONS & GESTURES
        // ========================================
        
        setupTouchInteractions() {
            if (!this.container) return;
            
            let lastTouchDistance = 0;
            let lastTouchCenter = { x: 0, y: 0 };
            
            // Touch start
            this.container.addEventListener('touchstart', (e) => {
                if (e.touches.length === 1) {
                    // Single touch - start dragging
                    this.isDragging = true;
                    this.startX = e.touches[0].clientX - this.translateX;
                    this.startY = e.touches[0].clientY - this.translateY;
                } else if (e.touches.length === 2) {
                    // Pinch gesture start
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    
                    lastTouchDistance = this.getDistance(touch1, touch2);
                    lastTouchCenter = this.getCenter(touch1, touch2);
                }
            }, { passive: false });
            
            // Touch move with throttling
            this.container.addEventListener('touchmove', this.throttle((e) => {
                if (e.touches.length === 1 && this.isDragging) {
                    // Single touch - dragging
                    e.preventDefault();
                    this.translateX = e.touches[0].clientX - this.startX;
                    this.translateY = e.touches[0].clientY - this.startY;
                    this.updateViewportTransform();
                } else if (e.touches.length === 2) {
                    // Pinch gesture
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    
                    const distance = this.getDistance(touch1, touch2);
                    const center = this.getCenter(touch1, touch2);
                    
                    if (lastTouchDistance > 0) {
                        const scale = distance / lastTouchDistance;
                        const newZoom = this.currentZoom * scale;
                        
                        if (newZoom >= this.minZoom && newZoom <= this.maxZoom) {
                            this.currentZoom = newZoom;
                            
                            // Adjust translation to zoom towards touch center
                            const deltaX = center.x - lastTouchCenter.x;
                            const deltaY = center.y - lastTouchCenter.y;
                            this.translateX += deltaX;
                            this.translateY += deltaY;
                            
                            this.updateViewportTransform();
                        }
                    }
                    
                    lastTouchDistance = distance;
                    lastTouchCenter = center;
                }
            }, 16), { passive: false });
            
            // Touch end
            this.container.addEventListener('touchend', () => {
                this.isDragging = false;
                lastTouchDistance = 0;
            });
            
            // Mouse events for desktop
            this.setupMouseInteractions();
        }
        
        setupMouseInteractions() {
            if (!this.container) return;
            
            this.container.addEventListener('wheel', (e) => {
                if (e.ctrlKey) {
                    // Zoom with Ctrl+scroll
                    e.preventDefault();
                    const scale = e.deltaY > 0 ? 0.9 : 1.1;
                    this.zoom(scale);
                }
            }, { passive: false });
            
            // Mouse drag
            this.container.addEventListener('mousedown', (e) => {
                if (e.button === 0) { // Left click
                    this.isDragging = true;
                    this.startX = e.clientX - this.translateX;
                    this.startY = e.clientY - this.translateY;
                    this.container.style.cursor = 'grabbing';
                }
            });
            
            this.container.addEventListener('mousemove', this.throttle((e) => {
                if (this.isDragging) {
                    this.translateX = e.clientX - this.startX;
                    this.translateY = e.clientY - this.startY;
                    this.updateViewportTransform();
                }
            }, 16));
            
            this.container.addEventListener('mouseup', () => {
                this.isDragging = false;
                this.container.style.cursor = 'grab';
            });
            
            this.container.addEventListener('mouseleave', () => {
                this.isDragging = false;
                this.container.style.cursor = 'grab';
            });
        }
        
        getDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        getCenter(touch1, touch2) {
            return {
                x: (touch1.clientX + touch2.clientX) / 2,
                y: (touch1.clientY + touch2.clientY) / 2
            };
        }
        
        // ========================================
        // FIND ME FUNCTIONALITY
        // ========================================
        
        setupFindMe() {
            const findMeBtn = document.getElementById('findMe');
            if (findMeBtn) {
                findMeBtn.addEventListener('click', () => this.scrollToPlayerMatch());
            }
        }
        
        scrollToPlayerMatch() {
            const playerMatch = document.querySelector('.player-match');
            if (playerMatch) {
                // Add pulse effect if motion is allowed
                if (!this.isReducedMotion) {
                    playerMatch.style.animation = 'none';
                    setTimeout(() => {
                        playerMatch.style.animation = 'playerPulse 1s ease-in-out 3';
                    }, 10);
                }
                
                // Smooth scroll to match
                playerMatch.scrollIntoView({ 
                    behavior: this.isReducedMotion ? 'auto' : 'smooth', 
                    block: 'center',
                    inline: 'center'
                });
                
                // Show notification
                this.showNotification('üèÜ Found your match!', 'success');
            } else {
                this.showNotification('üîç No active matches found', 'info');
            }
        }
        
        // ========================================
        // FLOATING ACTION BUTTONS
        // ========================================
        
        setupFloatingButtons() {
            const showMyPath = document.getElementById('showMyPath');
            const fullscreenToggle = document.getElementById('fullscreenToggle');
            const refreshBracket = document.getElementById('refreshBracket');
            
            if (showMyPath) {
                showMyPath.addEventListener('click', () => this.highlightPlayerPath());
            }
            
            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', () => this.toggleFullscreen());
            }
            
            if (refreshBracket) {
                refreshBracket.addEventListener('click', () => this.refreshBracket());
            }
        }
        
        highlightPlayerPath() {
            const playerMatches = document.querySelectorAll('.player-match');
            const playerRows = document.querySelectorAll('[data-player-id]');
            
            // Clear previous highlights
            document.querySelectorAll('.path-highlight').forEach(el => {
                el.classList.remove('path-highlight');
            });
            
            // Add path highlighting
            playerMatches.forEach(match => {
                match.classList.add('path-highlight');
            });
            
            playerRows.forEach(row => {
                if (row.closest('.player-match')) {
                    row.style.background = 'linear-gradient(135deg, rgba(0, 255, 65, 0.3), rgba(0, 245, 255, 0.2))';
                }
            });
            
            this.showNotification('‚ú® Highlighted your tournament path', 'success');
        }
        
        toggleFullscreen() {
            const bracket = document.querySelector('.tournament-bracket-wrapper');
            
            if (!document.fullscreenElement) {
                bracket.requestFullscreen().catch(err => {
                    console.log('Fullscreen failed:', err);
                    this.showNotification('‚ùå Fullscreen not supported', 'warning');
                });
            } else {
                document.exitFullscreen();
            }
        }
        
        refreshBracket() {
            this.showLoading();
            
            // Simulate refresh delay
            setTimeout(() => {
                this.hideLoading();
                this.showNotification('‚öôÔ∏è Bracket refreshed!', 'success');
                
                // Actual refresh logic can be added here
                // window.location.reload();
            }, 1500);
        }
        
        // ========================================
        // ROUND TOGGLE FUNCTIONALITY
        // ========================================
        
        toggleRound(roundNum) {
            const roundSection = document.querySelector(`[data-round="${roundNum}"]`);
            if (roundSection) {
                roundSection.classList.toggle('collapsed');
                
                // Update localStorage for persistence
                const collapsedRounds = JSON.parse(localStorage.getItem('collapsedRounds') || '[]');
                if (roundSection.classList.contains('collapsed')) {
                    if (!collapsedRounds.includes(roundNum)) {
                        collapsedRounds.push(roundNum);
                    }
                } else {
                    const index = collapsedRounds.indexOf(roundNum);
                    if (index > -1) {
                        collapsedRounds.splice(index, 1);
                    }
                }
                localStorage.setItem('collapsedRounds', JSON.stringify(collapsedRounds));
            }
        }
        
        // Restore collapsed state on load
        restoreRoundStates() {
            const collapsedRounds = JSON.parse(localStorage.getItem('collapsedRounds') || '[]');
            collapsedRounds.forEach(roundNum => {
                const roundSection = document.querySelector(`[data-round="${roundNum}"]`);
                if (roundSection) {
                    roundSection.classList.add('collapsed');
                }
            });
        }
        
        // ========================================
        // MATCH DETAIL FUNCTIONALITY
        // ========================================
        
        showMatchDetails(matchId) {
            // Find the match element
            const matchCard = document.querySelector(`[data-match-id="${matchId}"]`);
            if (!matchCard) return;
            
            // Create modal or overlay for match details
            const modal = document.createElement('div');
            modal.className = 'match-detail-modal';
            modal.innerHTML = `
                <div class="match-detail-content">
                    <div class="match-detail-header">
                        <h3>üèÜ Match Details</h3>
                        <button class="close-modal" onclick="this.parentElement.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="match-detail-body">
                        ${matchCard.innerHTML}
                        <div class="match-extra-info">
                            <p><strong>Match ID:</strong> ${matchId}</p>
                            <p><strong>Status:</strong> <span class="status-badge">Active</span></p>
                            <p><strong>Round:</strong> Current Round</p>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal styles with performance considerations
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                ${this.isMobile ? '' : 'backdrop-filter: blur(10px);'}
            `;
            
            const content = modal.querySelector('.match-detail-content');
            content.style.cssText = `
                background: var(--bracket-surface);
                border-radius: 1rem;
                padding: 2rem;
                max-width: 90vw;
                max-height: 80vh;
                overflow-y: auto;
                border: 1px solid var(--bracket-glass-border);
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            `;
            
            document.body.appendChild(modal);
            
            // Close on outside click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        // ========================================
        // KEYBOARD NAVIGATION
        // ========================================
        
        setupKeyboardNavigation() {
            document.addEventListener('keydown', (e) => {
                // Zoom shortcuts
                if (e.ctrlKey && e.key === '=') {
                    e.preventDefault();
                    this.zoom(1.2);
                } else if (e.ctrlKey && e.key === '-') {
                    e.preventDefault();
                    this.zoom(0.8);
                } else if (e.ctrlKey && e.key === '0') {
                    e.preventDefault();
                    this.resetZoom();
                }
                
                // Find me shortcut
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    this.scrollToPlayerMatch();
                }
                
                // Refresh shortcut
                if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
                    e.preventDefault();
                    this.refreshBracket();
                }
            });
        }
        
        // ========================================
        // PULL TO REFRESH
        // ========================================
        
        setupPullToRefresh() {
            if (!this.isMobile) return; // Only enable on mobile
            
            let startY = 0;
            let currentY = 0;
            let pullDistance = 0;
            const threshold = 100;
            
            this.container.addEventListener('touchstart', (e) => {
                if (this.container.scrollTop === 0) {
                    startY = e.touches[0].clientY;
                    this.isPulling = true;
                }
            });
            
            this.container.addEventListener('touchmove', (e) => {
                if (!this.isPulling) return;
                
                currentY = e.touches[0].clientY;
                pullDistance = currentY - startY;
                
                if (pullDistance > 0 && this.container.scrollTop === 0) {
                    e.preventDefault();
                    
                    if (this.pullRefreshIndicator) {
                        this.pullRefreshIndicator.style.transform = `translateY(${Math.min(pullDistance, threshold)}px)`;
                        
                        if (pullDistance >= threshold) {
                            this.pullRefreshIndicator.classList.remove('d-none');
                        }
                    }
                }
            });
            
            this.container.addEventListener('touchend', () => {
                if (this.isPulling && pullDistance >= threshold) {
                    this.refreshBracket();
                }
                
                this.isPulling = false;
                pullDistance = 0;
                
                if (this.pullRefreshIndicator) {
                    this.pullRefreshIndicator.style.transform = '';
                    setTimeout(() => {
                        this.pullRefreshIndicator.classList.add('d-none');
                    }, 300);
                }
            });
        }
        
        // ========================================
        // SWIPE NAVIGATION
        // ========================================
        
        setupSwipeNavigation() {
            if (!this.isMobile) return; // Only enable on mobile
            
            let startX = 0;
            let startY = 0;
            let isHorizontalSwipe = false;
            
            this.viewport.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                isHorizontalSwipe = false;
            });
            
            this.viewport.addEventListener('touchmove', (e) => {
                if (!startX || !startY) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;
                const diffX = startX - currentX;
                const diffY = startY - currentY;
                
                // Determine if this is a horizontal swipe
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    isHorizontalSwipe = true;
                }
            });
            
            this.viewport.addEventListener('touchend', (e) => {
                if (!startX || !startY || !isHorizontalSwipe) return;
                
                const endX = e.changedTouches[0].clientX;
                const diffX = startX - endX;
                
                // Navigate between rounds with swipe
                if (Math.abs(diffX) > 100) {
                    if (diffX > 0) {
                        this.navigateToNextRound();
                    } else {
                        this.navigateToPreviousRound();
                    }
                }
                
                startX = 0;
                startY = 0;
                isHorizontalSwipe = false;
            });
        }
        
        navigateToNextRound() {
            const rounds = document.querySelectorAll('.round-section:not(.collapsed)');
            if (rounds.length > 0) {
                const nextRound = rounds[Math.min(this.currentRoundIndex + 1, rounds.length - 1)];
                nextRound.scrollIntoView({ 
                    behavior: this.isReducedMotion ? 'auto' : 'smooth', 
                    block: 'start' 
                });
                this.currentRoundIndex = Math.min(this.currentRoundIndex + 1, rounds.length - 1);
            }
        }
        
        navigateToPreviousRound() {
            const rounds = document.querySelectorAll('.round-section:not(.collapsed)');
            if (rounds.length > 0) {
                const prevRound = rounds[Math.max(this.currentRoundIndex - 1, 0)];
                prevRound.scrollIntoView({ 
                    behavior: this.isReducedMotion ? 'auto' : 'smooth', 
                    block: 'start' 
                });
                this.currentRoundIndex = Math.max(this.currentRoundIndex - 1, 0);
            }
        }
        
        // ========================================
        // PERFORMANCE OPTIMIZATIONS
        // ======================================== 
        
        optimizePerformance() {
            // Enable GPU acceleration
            if (this.container) {
                this.container.style.transform = 'translate3d(0,0,0)';
                this.container.style.willChange = 'scroll-position';
            }
            
            // Throttle scroll events for virtual scrolling
            if (this.container) {
                let scrollTimeout;
                this.container.addEventListener('scroll', () => {
                    clearTimeout(scrollTimeout);
                    scrollTimeout = setTimeout(() => {
                        // Update visible matches for performance
                        this.updateVisibleMatches();
                    }, 16); // ~60fps
                });
            }
            
            // Optimize effects for mobile devices
            if (this.isMobile) {
                // Reduce backdrop filters and shadows on mobile
                document.querySelectorAll('.bracket-container, .tournament-bracket-wrapper').forEach(el => {
                    el.style.backdropFilter = 'none';
                });
            }
        }
        
        updateVisibleMatches() {
            if (!this.container) return;
            
            const containerRect = this.container.getBoundingClientRect();
            const matches = document.querySelectorAll('.match-card');
            
            matches.forEach(match => {
                const matchRect = match.getBoundingClientRect();
                const isVisible = (
                    matchRect.bottom >= containerRect.top &&
                    matchRect.top <= containerRect.bottom
                );
                
                // Toggle visibility for performance
                if (isVisible) {
                    match.style.visibility = 'visible';
                } else {
                    match.style.visibility = 'hidden';
                }
            });
        }
        
        // ========================================
        // UTILITY FUNCTIONS
        // ========================================
        
        throttle(func, delay) {
            let timeoutId;
            let lastExecTime = 0;
            return function (...args) {
                const currentTime = Date.now();
                
                if (currentTime - lastExecTime > delay) {
                    func.apply(this, args);
                    lastExecTime = currentTime;
                } else {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(() => {
                        func.apply(this, args);
                        lastExecTime = Date.now();
                    }, delay - (currentTime - lastExecTime));
                }
            };
        }
        
        showLoading() {
            if (this.loading) {
                this.loading.classList.remove('d-none');
            }
        }
        
        hideLoading() {
            if (this.loading) {
                this.loading.classList.add('d-none');
            }
        }
        
        showNotification(message, type = 'info') {
            // Announce to screen readers
            this.announceToScreenReader(message);
            
            const notification = document.createElement('div');
            notification.className = `bracket-notification ${type}`;
            notification.textContent = message;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--bracket-surface);
                color: white;
                padding: 1rem 2rem;
                border-radius: 0.5rem;
                border: 1px solid var(--bracket-glass-border);
                box-shadow: var(--bracket-shadow-lg);
                z-index: 1001;
                font-weight: 600;
                ${this.isMobile ? '' : 'backdrop-filter: blur(10px);'}
                animation: ${this.isReducedMotion ? 'none' : 'slideInFromTop 0.3s ease-out'};
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (!this.isReducedMotion) {
                    notification.style.animation = 'slideOutToTop 0.3s ease-out';
                }
                setTimeout(() => notification.remove(), this.isReducedMotion ? 0 : 300);
            }, 3000);
        }
        
        announceToScreenReader(message) {
            const announcer = document.getElementById('bracketAnnouncer');
            if (announcer) {
                announcer.textContent = message;
                // Clear after announcement to allow repeated announcements
                setTimeout(() => {
                    announcer.textContent = '';
                }, 1000);
            }
        }
    }
    
    // Global functions for HTML event handlers
    function toggleRound(roundNum) {
        if (window.bracketInstance) {
            window.bracketInstance.toggleRound(roundNum);
        }
    }
    
    function showMatchDetails(matchId) {
        if (window.bracketInstance) {
            window.bracketInstance.showMatchDetails(matchId);
        }
    }
    
    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
        window.bracketInstance = new TournamentBracket();
    });
    
    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideInFromTop {
            from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        
        @keyframes slideOutToTop {
            from { transform: translateX(-50%) translateY(0); opacity: 1; }
            to { transform: translateX(-50%) translateY(-100%); opacity: 0; }
        }
        
        .path-highlight {
            border-color: var(--bracket-green) !important;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.8) !important;
            animation: pathPulse 2s ease-in-out infinite;
        }
        
        @keyframes pathPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes playerPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: var(--bracket-shadow-md);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: var(--bracket-glow-green), var(--bracket-shadow-lg);
            }
        }
        
        @keyframes bracketConnectorGlow {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
            }
            50% { 
                box-shadow: 0 0 20px rgba(0, 245, 255, 0.8), 0 0 30px rgba(0, 255, 65, 0.4);
            }
        }
        
        /* Apply connector animation on desktop */
        @media (min-width: 1024px) {
            .round-section:not(:last-child)::after {
                animation: bracketConnectorGlow 3s ease-in-out infinite;
            }
        }
        
        /* Screen reader only class for accessibility */
        .sr-only {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }
    `;
    document.head.appendChild(style);
</script>

{% endblock %}